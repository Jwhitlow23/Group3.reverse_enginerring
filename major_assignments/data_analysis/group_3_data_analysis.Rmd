---
title: "group_3_data_analysis"
group: Will Beltran, Sarah Siock, Jamille Whitlow and Stephanie Quinn
output: html_document
date: "2022-11-12"
---

We decided to use the 2021 and 2022 datasets on politicians’ election tweets. We plan to merge it with data on campaign contributions.

Limitations or flaws:
The data does not contain the number of followers for each account. Nor does it contain the number of likes, retweets or replies for each tweet.

If we wanted to analyze the impact of particular tweets or tweet terms on engagement with politicians’ Twitter accounts - and if the number of tweets and politicians was manageable enough - we could look up the tweets on Twitter and create a new column to show numbers of likes and retweets. We could do this to compare engagement with tweets using certain phrases or on certain topics.

Things we might not be able to answer (with our current knowledge):
We’ve only started to dive into the world of text analysis, but we think we’ll have to figure out how to find the incidence of particular words or phrases across tweets in order to answer some of our questions. We were able to use tidytext to find the most common words and bigrams in the data, which will help us select a topic to focus on, but we haven’t figured out how to search for particular words. We attempted to find codes that would allow us to complete this type of analysis and came across the verb grepl. However, none of us were able to run grepl due to it not loading completely. It is possible we did not have the correct package installed to run grepl.

Also, we’re not sure exactly how to measure change in tweeting behavior over time. We checked the data type of the timestamp column and found that it is <dttm>, which we’ve never used before. Are there any tips we should know if we want to measure change over time?

Our exploratory analysis:
```{r}
install.packages("tidytext")
```
```{r}
library(tidyverse)
library(janitor)
library(tidytext)
```

```{r}
#EXPLORING THE DATA
# The 2021 tweet dataframe has 12 columns and 557,987 rows, and the 2022 tweet dataframe has 12 columns and 429,093 rows.

tweets_2021 <- read_csv("tweets2021.csv")
tweets_2022 <- read_csv("tweets_2022.csv")

```

```{r}
# In the 2021 data, Sen. Ted Cruz (R-TX) tweeted the most, with 7,864 tweets. Sen. John Cornyn (R-TX) was close behind, with 6,948 tweets.
tweets_2021 %>% 
  group_by(last_name, first_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count))
```
```{r}
#In 2022, Rep. Don Bacon (R-NE) barely displaced Cruz as top tweeter, with 7,285 tweets. Cruz had one less tweet, with 7,284 tweets.
tweets_2022 %>% 
  group_by(last_name, first_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count))

```
```{r}
# The combined 2021 and 2022 dataframe has 987,080 rows and 12 variables.
combined_tweets <- bind_rows(tweets_2021, tweets_2022)
```
```{r}
#Cruz, Bacon and Cornyn dominated the combined tweet dataframe, at first, second and third most prolific. Sen. Marco Rubio (R-FL) is also a major tweeter. Rep. Pramila Jayapal (D-WA) came in at number 5.
combined_tweets %>% 
  group_by(last_name, first_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count))
```
```{r}
#California, Texas, Florida, New York and Illinois politicians had the highest numbers of tweets in the combined data. These are large states with a lot of House representatives and that have a lot of electoral votes in years of presidential races. Pennsylvania had sixth most numbers of tweets, possibly having to do with being a battleground state.
combined_tweets %>% 
  group_by(state) %>% 
  summarize(count=n()) %>% 
  arrange(desc(count))
```
```{r}
# Even though the top tweeters are Republicans, Democrats had a larger total number of tweets in the combined data, with 557,830 compared to 426,947 tweets from Republicans. Maybe more Democrats tweet modest amounts, but some Republicans tweet very frequently.
combined_tweets %>% 
  group_by(party_id) %>% 
  summarize(count=n()) %>% 
  arrange(desc(count))
```
```{r}
#We drew on the text analysis textbook chapter to identify the most common words, preparing the data first.
#combined_tweets <- combined_tweets %>%
 # mutate(content = gsub("http.*","", content))

unique_words <- combined_tweets %>% select(content) %>%
  unnest_tokens(word, content)
```

```{r}
#These words were common, but not very telling. 
unique_words %>%
  count(word, sort = TRUE) %>%
  top_n(25) %>%
  mutate(word = reorder(word, n))
```
```{r}
#We used stop_words to remove common words like "the" and "is" from our results. We think "Rt" shows that lots of politicians were re-tweeting material, while we think "amp" has to do with tweeting out urls. Politicians are tweeting about legislation ("bill" and "act"), Biden and possibly touting their family values ("families"). Possible issues that stand out from the tweets are healthcare or possibly covid ("health" and "care"), immigration ("border"), infrastructure or the infrastructure bill ("infrastructure"), energy (possibly having to do with the Keystone pipeline or disruptions caused by the Russian invasion of Ukraine - "energy") and inflation ("inflation").
unique_words %>%
  anti_join(stop_words) %>%
  group_by(word) %>%
  tally(sort=TRUE)
```
```{r}
#Finding common words in 2021 data only. We're not sure why this data appears to be the same as the combined dataframe text analysis. So we decided to find common words in the 2022 data.
tweets_2021_2 <- tweets_2021 %>%
  mutate(content = gsub("http.*","", content))
```
```{r}
tweets_2021_2 <- combined_tweets %>% select(content) %>%
  unnest_tokens(word, content)
```
```{r}
tweets_2021_2 %>%
  anti_join(stop_words) %>%
  group_by(word) %>%
  tally(sort=TRUE)

```
```{r}
#Finding common tweets in 2022 data only. This data is different from the combined dataframe text analysis. But we still don't understandwhy the 2022 data don't appear to be taken account of in the text analysis for the combined tweets.
tweets_2022_2 <- tweets_2022 %>%
  mutate(content = gsub("http.*","", content))
```
```{r}
tweets_2022_2 <- combined_tweets %>% select(content) %>%
  unnest_tokens(word, content)
```
```{r}
tweets_2022_2 %>%
  anti_join(stop_words) %>%
  group_by(word) %>%
  tally(sort=TRUE)


```

```{r}
# We also tried a bigram analysis on the combined data, which showed lots of politicians offering their condolences to Rep. Jamie Raskin (D-MD) after he lost his son to suicide a few days before the Jan. 6 insurrection. Were these tweets from the time between Raskin's son's suicide and the insurrection? We were struck that the most common bigrams were not about the insurrection itself. We wondered if the trigrams would show anything different, but we were unable to get the code to work.
combined_tweets %>%
  filter(created < '2021-01-01') %>%
  unnest_tokens(bigram, content, token = "ngrams", n = 2) %>%
  separate(bigram, c("word1", "word2"), sep = " ") %>%
  filter(!word1 %in% stop_words$word) %>%
  filter(!word2 %in% stop_words$word) %>%
  mutate(bigram = paste(word1, word2, sep=" ")) %>%
  group_by(bigram) %>%
  tally(sort=TRUE) %>%
  mutate(percent = (n/sum(n))*100) %>%
  top_n(10)
```
ELECTION FRAUD

```{r}
#QUESTION 1
#How many politicians tweeted keywords about our topic in the time period we are analyzing? Did more Republicans or Democrats tweet about it?

#First, we lowercased the content column to better search the politicians' tweets. Then we filters for terms relevant to election fraud and saved the result as a new dataframe.
combined_tweets_new <-
  combined_tweets %>% 
  mutate(lowercase_content = str_to_lower(content))
```
```{r}
fraud_tweets <- combined_tweets_new %>% 
filter(str_detect(lowercase_content, "stop the steal|election fraud|voter fraud|ballot harvesting|#stopthesteal|#ballotharvesting"))
```
```{r}
glimpse(fraud_tweets)

```
```{r}
#We got a list of all politicians in the data who authored tweets containing our search terms. In order to do this, we filtered for tweets containing those terms and then used group_by and summarize to show the authors of the tweets in order of how many tweets they tweeted.
fraud_tweets %>% 
filter(str_detect(lowercase_content, "election fraud|stop the steal|voter fraud|harvesting|ballot harvesting")) %>% 
  group_by(first_name, last_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count))
```
```{r}
#We found the number of tweets containing our search terms that were authored by Republicans by using filter and summarize. There are 365 tweets in the data that contain one of our search terms and were tweeted by Republicans.
fraud_tweets %>% 
filter(str_detect(lowercase_content, "election fraud|stop the steal|voter fraud|harvesting|ballot harvesting")) %>% 
  filter(party_id == "2") %>% 
  summarize(count = n()) 
  
```
```{r}
#We followed the same steps as in the previous codeblock, but for Democrats. There are 243 tweets that contain our search terms and were authored by Democrats. 
fraud_tweets %>% 
filter(str_detect(lowercase_content, "election fraud|stop the steal|voter fraud|harvesting|ballot harvesting")) %>% 
  filter(party_id == "1") %>% 
  summarize(count = n()) 
```
```{r}
#To find the number of Republican politicians responsible for the 365 tweets, we filtered by our search terms and then by party. Then we used group_by and summarize and got a list of Republicans who tweeted on election fraud and how many tweets each one authored. The tibble shows us that there are 110 Republicans on this list.
fraud_tweets %>% 
filter(str_detect(lowercase_content, "election fraud|stop the steal|voter fraud|harvesting|ballot harvesting")) %>% 
  filter(party_id == "2") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count = n())
```

```{r}
#We repeated the same steps as above for Democrats and got 86 Democrats who tweeted using our search terms. 

fraud_tweets %>% 
filter(str_detect(lowercase_content, "election fraud|stop the steal|voter fraud|harvesting|ballot harvesting")) %>% 
  filter(party_id == "1") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count = n())
```
```{r}
#One independent also tweeted using our search terms. So, more Republicans than Democrats tweeted about election fraud, but the number of Democrats was significant. We think they were probably debunking election fraud claims. We find it interesting that this many Democrats are tweeting about a topic that was fueled by Republicans and alt-right conspiracies.
fraud_tweets %>% 
filter(str_detect(lowercase_content, "election fraud|stop the steal|voter fraud|harvesting|ballot harvesting")) %>% 
  filter(party_id == "3") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count = n())
```

```{r}
#QUESTION 2
#What are politicians re-tweeting? Do Democratic politicians retweet from progressive-leaning publications? Do Republican politicians retweet from conservative-leaning ones? Do politicians share ordinary people’s tweets?

(#Add code to find qt's?)
retweets <- combined_tweets_new %>% 
  filter(str_detect(lowercase_content, "rt @"))
```
```{r}
#This code shows the top Republican politicians who retweeted from our list of conservative news outlets. We got 160 Republican politicians who met this criteria. Sen. Ted Cruz (R-TX), Rep. Matt Gaetz (R-FL) and Rep. Jim Jordan (R-OH) were the most prolific tweet authors on this list.
#In order to find and rank Republican tweet authors, we used str_detect to filter for the conservative publications, filtered again for Republicans, and then used group_by, summarize and arrange.
retweets %>% 
  filter(str_detect(lowercase_content, "@newsmax|@oann|@foxnews|@realdailywire|@breitbartnews|@epochtimes|@dcexaminer|@nro|@fdrlst")) %>% 
  filter(party_id == "2") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count= n()) %>% 
  arrange(desc(count))
```
```{r}
#This code shows the top Republican politicians who retweeted from our list of left-leaning news outlets. We got 13 Republican politicians who met this criteria. Rep. Don Bacon (R-NE), Rep. Adam Kinzinger (R-IL) and Rep. Michael McCaul (R-TX) were the most prolific tweet authors on this list, although these numbers were very small
#In order to find and rank Republican tweet authors, we used the same sequence of str_detect, filter and then group_by, summarize and arrange.

retweets %>% 
  filter(str_detect(lowercase_content, "@huffpost|@thedailybeast|@slate|@voxdotcom|@msnbc|@theintercept")) %>% 
  filter(party_id == "2") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count= n()) %>% 
  arrange(desc(count))
```
```{r}
#This code shows the top Republican politicians who retweeted from our list of mainstream news outlets. We got 144 Republican politicians who met this criteria. Sen. Ted Cruz (R-TX), Rep. Don Bacon (R-NE) and Rep. Matt Gaetz (R-FL) were the most prolific tweet authors on this list.
#In order to find and rank Republican tweet authors, we used the same sequence of str_detect, filter and then group_by, summarize and arrange.
retweets %>% 
  filter(str_detect(lowercase_content, "@nytimes|@washingtonpost|@latimes|@abc|@nbcnews|@cnn|@politico|@thehill")) %>% 
  filter(party_id == "2") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count= n()) %>% 
  arrange(desc(count))
```

```{r}
# For this code block we used string detect to filter for re tweets from right leaning publications. We then put another filter to see just democrats' tweets. There are 20 democratic politicians who re tweeted these right leaning outlets. Chris Murphy, Ruben Gallego and Chris Coons were the three politicians who re tweeted the most from these outlets.
retweets %>% 
  filter(str_detect(lowercase_content, "@newsmax|@oann|@foxnews|@realdailywire|@breitbartnews|@epochtimes|@dcexaminer|@nro|@fdrlst")) %>% 
  filter(party_id == "1") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count= n()) %>% 
  arrange(desc(count))
```
```{r}
# For this code block we used string detect to filter for re tweets from left leaning publications. We then put another filter to see just democrats' tweets. There are 111 democratic politicians who re tweeted these right leaning outlets. Joaquin Castro, Ayanna	Pressley and Eric	Swalwell were the three politicians who re tweeted the most from these outlets.
retweets %>% 
  filter(str_detect(lowercase_content, "@huffpost|@thedailybeast|@slate|@voxdotcom|@msnbc|@theintercept")) %>% 
  filter(party_id == "1") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count= n()) %>% 
  arrange(desc(count))
```
```{r}
#For this code block we used string detect to filter for re tweets from mainstream publications. We then put another filter to see just democrats' tweets. There are 185 democratic politicians who re tweeted mainstream outlets. Joaquin	Castro, Pramila Jayapal and Norma	Torres were the three politicians who re tweeted the most from these outlets.
retweets %>% 
  filter(str_detect(lowercase_content, "@nytimes|@washingtonpost|@latimes|@abc|@nbcnews|@cnn|@politico|@thehill")) %>% 
  filter(party_id == "1") %>% 
  group_by(first_name, last_name) %>% 
  summarize(count= n()) %>% 
  arrange(desc(count))
```

```{r}
#We tried to see how often politicians retweet accounts not for other politicians, news organizations, or government/political institutional accounts, but we had trouble filtering out all the accounts. Also, we concluded that it's difficult to define "ordinary." We used !str_detect to filter out the names of the publications on our lists, as well as @rep and @sen to avoid other politicians' accounts. We also started filtering out some other accounts that showed up when we did our initial search, but there were too many accounts to filter them all out individually. We might abandon that part of the question.
combined_tweets_new %>% 
  filter(str_detect(lowercase_content, "rt @")) %>% 
    filter(!str_detect(lowercase_content, "@nytimes|@washingtonpost|@latimes|@abc|@nbcnews|@cnn|@politico|@thehill|@huffpost|@thedailybeast|@slate|@voxdotcom|@msnbc|@theintercept|@newsmax|@oann|@foxnews|@realdailywire|@breitbartnews|@epochtimes|@dcexaminer|@nro|@fdrlst|@rep|@sen|@HouseGOP|@SteveScalise|@houseforeign"))
  
```
```{r}
#In order to figure out which accounts are official versus personal, we did a filter and str_detect for Cruz and cruz, since we knew Ted Cruz has two accounts. The account with the account_type_id 1 linked to a book Cruz wrote, while the account labeled 2 links to his official Senate page. So we're pretty confident 2 is for official accounts.
combined_tweets_new %>% 
  filter(str_detect(user_name, "Cruz|cruz"))
```
```{r}
#QUESTION 3: In cases of candidates with personal and official campaign Twitter accounts, how did content on candidates’ personal accounts differ from content on their campaign accounts? Did keywords about our topic show up on both accounts, or on one more than the other?

#Within fraud_tweets, 28 different personal accounts are represented. In order to figure this out, we grouped by user_name, filtered for account type 1 and counted the results.
fraud_tweets %>% 
  group_by(user_name) %>% 
  filter(account_type_id == 1) %>% 
  summarize(count = n())

#There are 185 different official accounts represented in fraud_tweets. People who did tweet about election fraud were not shy about doing so on their official accounts.
fraud_tweets %>% 
  group_by(user_name) %>% 
  filter(account_type_id == 2) %>% 
  summarize(count = n())

```
```{r}
#how many politicians in fraud_tweets have both personal and official accounts?
```
```{r}
#There were 115 tweets from personal accounts using our terms about election fraud. We filtered for account type 1 and then did filter and string detect for our search terms. The 28 personal account holders in fraud_tweets tweeted, on average, 4.1 times about election fraud (115/28).
fraud_tweets %>% 
  filter(account_type_id == 1) %>% 
  filter(str_detect(lowercase_content, "stop the steal|election fraud|voter fraud|ballot harvesting|#stopthesteal|#ballotharvesting"))
```
```{r}
#There were 501 tweets from official accounts using our terms about election fraud. We filtered for account type 2 and then did filter and string detect for our search terms. The 185 different official account holders in fraud_tweets tweeted, on average, 2.7 times about election fraud (501/185).
fraud_tweets %>% 
  filter(account_type_id == 2) %>% 
  filter(str_detect(lowercase_content, "stop the steal|election fraud|voter fraud|ballot harvesting|#stopthesteal|#ballotharvesting"))
```
```{r}
#QUESTION 4: What proportion of candidates’ election tweets were endorsements for other candidates? How many of those endorsed candidates were in different states or were running for different offices (such as someone running for the House endorsing a Senate candidate)? Were there cases where these endorsements seem to have had a significant effect on contributions to the author of the tweet or the politician they endorsed?

#We decided not to do our original question 4 because it would be too difficult to islate tweets with endorsements.

#NEW QUESTION 4: How are different politicians using Twitter with regard to engagement with other users? Who are the politicians that mostly use their accounts to mention or retweet other users? Which politicians just use Twitter to make announcements?


combined_tweets_new %>% 
  group_by(last_name, first_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count))
```
```{r}
#In order to figure out whether Rep. Dwight Evans (R-PA) tends to retweet or otherwise engage with followers and other users, we filtered for his tweets and then did a string detect for "rt @" in the content column. Of Evans' 10,150 tweets, he retweeted in 6,744 - well over half.
evans_tweets <- combined_tweets_new %>% 
  filter(first_name == "Dwight",
         last_name == "Evans")
```
```{r}
evans_tweets %>% 
  filter(str_detect(lowercase_content, "rt @"))
```
```{r}
#We filtered for Evans' tweets that mentioned other accounts but were not retweets. We got 1,638 tweets, meaning that 8,382 of Evans' 10,150 tweets were retweets or mentions of other accounts. Combined with the large number of retweets, this suggests that Evans uses Twitter with the intention of engaging in conversations with other users, or perhaps telegraphing whom he associates himself with. Most of Evans' tweets are not original content.
evans_tweets %>% 
  filter(str_detect(lowercase_content, "@")) %>% 
  filter(!str_detect(lowercase_content, "^rt"))
```
```{r}
cornyn_tweets <- combined_tweets_new %>% 
  filter(first_name == "John",
         last_name == "Cornyn")
```
```{r}
# Sen. John Cornyn (R-TX) had 5,649 retweets out of a total 11,707. Compared to Evans, who had 66% retweets, Cornyn had 48% retweets.
cornyn_tweets %>% 
  filter(str_detect(lowercase_content, "rt @"))
```
```{r}
# mentions
x <- cornyn_tweets %>% filter(str_detect(lowercase_content,"@")) %>% filter(!str_detect(lowercase_content,"^rt"))
```
```{r}
#QUESTION 5: Were there any tweets about our topic that seem to have had major effects on candidates’ contribution numbers or amounts?

#We decided to look at FEC data for the politicians who were the most prolific tweeters. We started with Ted Cruz, so we read in the csv files of his receipt data.
cruz_receipts <- read_csv("~/Documents/GitHub/Group3.reverse_enginerring/major_assignments/data_analysis/cruz_receipts.csv")
```
```{r}
# The day with the highest number of contributions was Dec. 8, 2021. In order to get this date, we grouped by receipt date, counted the number of contributions for each day, totaled the amounts received, and then arranged the days in order of number of contributions.
cruz_receipts %>% 
  group_by(contribution_receipt_date) %>% 
  summarize(number_contributions = n(),
            contribution_receipt_amount = sum(contribution_receipt_amount)) %>% 
  arrange(desc(number_contributions)) 
```
```{r}
#The day with the largest contribution amount was June 30, 2021. In order to get this date, we grouped by receipt date, counted the number of contributions for each day, totaled the amounts received, and then arranged the days in order of contribution amount.

cruz_receipts %>% 
  group_by(contribution_receipt_date) %>% 
  summarize(number_contributions = n(),
            contribution_receipt_amount = sum(contribution_receipt_amount)) %>% 
  arrange(desc(contribution_receipt_amount))
```
```{r}
# On the day Cruz received the most contributions, he tweeted the most about Russia (and Joe Biden capitulating to him) and a few tweets about vaccine mandates.  We made a new dataframe after filtering for Cruz's first and last name and rows in the "created" column beginning with Dec. 8, 2021 (since the data also contains timestamps for the tweets).
cruz_most_contributions <- combined_tweets_new %>% 
  filter(first_name == "Ted",
         last_name == "Cruz",
         str_detect(created, "^2021-12-08"))
```
```{r}
# On the day Cruz received the largest amount of money, he tweeted, "Joe Biden and Kamala Harris are the last mile of the human trafficking network that's resulting in the abuse of thousands of little boys, thousands of little girls."
cruz_largest_amount <- combined_tweets_new %>% 
  filter(first_name == "Ted",
         last_name == "Cruz",
         str_detect(created, "^2021-06-30"))
```

```{r}
jayapal_receipts <- read_csv("~/Documents/GitHub/Group3.reverse_enginerring/major_assignments/data_analysis/jayapal_receipts.csv")
```
```{r}
#The day with the largest number of contributions was Sept. 30, 2022. In order to get this date, we grouped by receipt date, counted the number of contributions for each day, totaled the amounts received, and then arranged the days in order of contribution amount.

jayapal_receipts %>% 
  group_by(contribution_receipt_date) %>% 
  summarize(number_contributions = n(),
            contribution_receipt_amount = sum(contribution_receipt_amount)) %>% 
  arrange(desc(number_contributions))
```
```{r}
#The day with the largest contribution amount was March 31, 2022. In order to get this date, we grouped by receipt date, counted the number of contributions for each day, totaled the amounts received, and then arranged the days in order of contribution amount.

jayapal_receipts %>% 
  group_by(contribution_receipt_date) %>% 
  summarize(number_contributions = n(),
            contribution_receipt_amount = sum(contribution_receipt_amount)) %>% 
  arrange(desc(contribution_receipt_amount))
```
```{r}
#On the day Jayapal got the highest number of contributions, she tweeted in support of Justice Ketanji Brown Jackson and abortion rights.
jayapal_most_contributions <- combined_tweets_new %>% 
  filter(first_name == "Pramila",
         last_name == "Jayapal",
         str_detect(created, "^2022-09-30"))
```
```{r}
#On the day Jayapal raised the largest amount money, she tweeted several times about trans rights for the Trans Day of Visibility, as well as about the importance of combating anti-Asian hate. 
jayapal_largest_amount <- combined_tweets_new %>% 
  filter(first_name == "Pramila",
         last_name == "Jayapal",
         str_detect(created, "^2021-03-31"))
```

```{r}
bacon_receipts <- read_csv("~/Documents/GitHub/Group3.reverse_enginerring/major_assignments/data_analysis/bacon_receipts.csv")
```
```{r}
#The day with the largest number of contributions was Dec. 2, 2022. In order to get this date, we grouped by receipt date, counted the number of contributions for each day, totaled the amounts received, and then arranged the days in order of contribution amount.
bacon_receipts %>% 
  group_by(contribution_receipt_date) %>% 
  summarize(number_contributions = n(),
            contribution_receipt_amount = sum(contribution_receipt_amount)) %>% 
  arrange(desc(number_contributions))
```

```{r}
#The day with the largest contribution amount was the same as the day Bacon got the largest number of contributions: Dec. 2, 2021. In order to get this date, we grouped by receipt date, counted the number of contributions for each day, totaled the amounts received, and then arranged the days in order of contribution amount.
bacon_receipts %>% 
  group_by(contribution_receipt_date) %>% 
  summarize(number_contributions = n(),
            contribution_receipt_amount = sum(contribution_receipt_amount)) %>% 
  arrange(desc(contribution_receipt_amount))
```


```{r}
#On the day Bacon got the largest number and highest amount of contributions, he tweeted about a wide variety of issues, from Russia and Israel to the Capitol Christmas tree. Bacon also mentioned Nebraska more than the other politicians mentioned their states. Ted Cruz tweets a lot about the border and immigration, but this is a national as well as state issue.
bacon_most_contributions <- combined_tweets_new %>% 
  filter(first_name == "Don",
         last_name == "Bacon",
         str_detect(created, "^2021-12-02"))
```

```{r}
#We noticed that Bacon tweeted in support of the American Israel Public Affairs Committee on the day he received the largest number and amount of contributions, and that AIPAC contributed to his campaign. We used filter and string detect to find all contributions from pro-Israel committees, and then used summarize to find that he received $177,323 from these groups.
bacon_receipts %>%  filter(str_detect(contributor_name, "ISRAEL"))%>% summarise(sum(contribution_receipt_amount))
```

```{r}

#MOST NEWSWORTHY: Sen. Ted Cruz (R-TX) raised the largest amount of money the day he appeared on Fox News and said,
"Joe Biden and Kamala Harris are the last mile of the human trafficking network that's resulting in the abuse of thousands of little boys, thousands of little girls." Cruz was likening the Biden and Harris administration's immigration and border policies to human trafficking. We think this is newsworthy because it suggests that Cruz's supporters agree with this statement and possibly that it makes them feel that they are doing a good thing by contributing to Cruz.

#WHERE WE'RE GOING: Next week, we would like to more systematically compare different politicians' numbers of total tweets, retweets and mentions that were not retweets. Are there obvious outliers? And what buckets can divide them into? Is there a distinction between Republicans and Democrats? What conclusions can we draw from the trends we see?

#THINGS WE'VE LEARNED SO FAR: Claims of election fraud were fueled by Republican politicians, but a significant number of Democrats tweeted about it as well (to debunk it). We think this is significant because it suggests that Republicans' claims had a noticeable impact on both Republicans' and Democrats' conversations in the run-up to the general elections. It would be interesting to see whether these politicians are talking to other politicians in their election fraud tweets, or whether they are just speaking to their followers or general Twitter users. We could potentially explore this by looking for whether politicians used mentions while tweeting about voter fraud.

#Also, politicians generally retweet from news publications that align with their political affiliations.

#IT appears that politicians were more likely to tweet about election fraud from official accounts than personal accounts. This is not what we would have expected. We can't see this from the data we have, but we were curious whether this is because politicians had more followers on official accounts.

--
[Notes for the future: For each politician add a column with total tweets, total retweets, total mentions. Then look for outliers. What buckets can we put them in? Is it by party lines? Be an anthropologist! What time do they tweet?

Differences between campaign, personal and official accounts? (is that for another question?)]